<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Add Property - Smart Rent House</title>
    <style>
        :root{--bg:#f6f8fb;--card:#ffffff;--accent:#4f46e5;--muted:#6b7280;--error:#ef4444}
        html,body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(135deg,#eef2ff 0%, #f8fafc 100%);color:#0f172a;min-height:100vh}
        .navbar{background:#fff;padding:16px 32px;box-shadow:0 2px 8px rgba(15,23,42,0.04);display:flex;justify-content:space-between;align-items:center}
        .logo{font-weight:700;color:var(--accent)}
        .nav-links{display:flex;gap:16px}
        .nav-links a{color:var(--accent);text-decoration:none;font-weight:500}
        .container{max-width:900px;margin:32px auto;padding:0 32px;margin-bottom:32px}
        h1{font-size:2rem;margin:0 0 8px}
        .lead{color:var(--muted);margin:0 0 24px}
        .step-indicator{display:flex;justify-content:space-between;margin-bottom:32px;position:relative}
        .step-indicator::before{content:'';position:absolute;top:24px;left:0;right:0;height:2px;background:#e5e7eb}
        .step{flex:1;text-align:center;position:relative;z-index:1}
        .step-circle{width:48px;height:48px;margin:0 auto 8px;background:#e5e7eb;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:600;color:var(--muted)}
        .step.active .step-circle{background:var(--accent);color:white}
        .step.completed .step-circle{background:#10b981;color:white}
        .step-label{font-size:0.9rem;color:var(--muted);font-weight:500}
        .form-card{background:var(--card);padding:32px;border-radius:12px;box-shadow:0 2px 8px rgba(15,23,42,0.06)}
        .form-group{margin-bottom:24px}
        label{display:block;margin-bottom:8px;font-weight:600;color:#0f172a}
        input[type="text"],input[type="email"],input[type="number"],textarea,select{width:100%;padding:12px;border:1px solid #e5e7eb;border-radius:8px;font-family:inherit;font-size:1rem;box-sizing:border-box;transition:border-color 0.2s}
        input[type="text"]:focus,input[type="email"]:focus,input[type="number"]:focus,textarea:focus,select:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(79,70,229,0.1)}
        textarea{resize:vertical;min-height:120px}
        .form-row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
        .form-group.full{grid-column:1/-1}
        .location-section{background:#f9fafb;padding:16px;border-radius:8px;border:1px solid #e5e7eb;margin-bottom:16px}
        .location-info{font-size:0.9rem;color:var(--muted);margin-bottom:12px;padding:12px;background:white;border-radius:6px}
        .map-container{width:100%;height:300px;background:#e5e7eb;border-radius:8px;display:flex;align-items:center;justify-content:center;margin-bottom:12px;cursor:pointer;border:2px solid #d1d5db;transition:all 0.2s}
        .map-container:hover{border-color:var(--accent);background:#f0f1ff}
        .btn{display:inline-block;padding:12px 24px;border-radius:10px;background:var(--accent);color:white;text-decoration:none;font-weight:600;cursor:pointer;border:none;font-size:1rem;width:100%;text-align:center;transition:all 0.2s}
        .btn:hover{opacity:0.9}
        .btn-secondary{background:transparent;border:1px solid var(--accent);color:var(--accent)}
        .form-footer{display:flex;gap:12px;margin-top:32px}
        .form-footer a{flex:1;text-align:center;padding:12px;text-decoration:none;color:var(--accent);font-weight:600}
        .helper-text{color:var(--muted);font-size:0.9rem;margin-top:4px}
        .required{color:var(--error)}
        .alert{padding:12px 16px;border-radius:8px;margin-bottom:16px}
        .alert-success{background:#dcfce7;color:#166534}
        .alert-error{background:#fee2e2;color:#991b1b}
        @media (max-width:768px){.form-row{grid-template-columns:1fr}.container{padding:0 16px}}
    </style>
</head>
<body>
<!-- Navbar -->
<div class="navbar">
    <div class="logo">Smart Rent House</div>
    <div class="nav-links">
        <a th:href="@{/home}">Home</a>
        <a th:href="@{/logout}">Logout</a>
    </div>
</div>

<!-- Main Content -->
<div class="container">
    <h1>Add Your Property</h1>
    <p class="lead">List your property for rent. Step 1 of 3: Property Details</p>

    <!-- Step Indicator -->
    <div class="step-indicator">
        <div class="step active">
            <div class="step-circle">1</div>
            <div class="step-label">Details</div>
        </div>
        <div class="step">
            <div class="step-circle">2</div>
            <div class="step-label">Images</div>
        </div>
        <div class="step">
            <div class="step-circle">3</div>
            <div class="step-label">Documents</div>
        </div>
    </div>

    <!-- Messages -->
    <div th:if="${message}" class="alert alert-success" th:text="${message}"></div>
    <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>

    <!-- Form Card -->
    <div class="form-card">
        <form th:action="@{/landlord/add-property}" method="POST" th:object="${property}">
            <!-- CSRF Token -->
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

            <!-- Basic Information -->
            <div class="form-row">
                <div class="form-group">
                    <label for="name">House Name/Title <span class="required">*</span></label>
                    <input type="text" id="name" name="name" placeholder="e.g., Cozy 2-BHK Apartment" required>
                    <p class="helper-text">Give your property an attractive title</p>
                </div>
                <div class="form-group">
                    <label for="ownerName">Your Full Name <span class="required">*</span></label>
                    <input type="text" id="ownerName" name="ownerName" placeholder="e.g., John Doe" required>
                    <p class="helper-text">Property owner's name</p>
                </div>
            </div>

            <!-- Price -->
            <div class="form-group">
                <label for="price">Monthly Rent (‚Çπ) <span class="required">*</span></label>
                <input type="number" id="price" name="price" placeholder="e.g., 25000" min="1000" step="500" required>
                <p class="helper-text">Enter the monthly rental price</p>
            </div>

            <!-- Address Fields -->
            <div class="form-group">
                <label for="address">Full Street Address <span class="required">*</span></label>
                <input type="text" id="address" name="address" placeholder="e.g., 123 Main Street, Building A, Floor 3" required>
                <p class="helper-text">Complete street address and building details</p>
            </div>

            <!-- City, State, Pincode -->
            <div class="form-row">
                <div class="form-group">
                    <label for="city">City <span class="required">*</span></label>
                    <input type="text" id="city" name="city" placeholder="e.g., Mumbai" required>
                    <p class="helper-text">City name</p>
                </div>
                <div class="form-group">
                    <label for="state">State/Province <span class="required">*</span></label>
                    <input type="text" id="state" name="state" placeholder="e.g., Maharashtra" required>
                    <p class="helper-text">State or province</p>
                </div>
            </div>

            <div class="form-group">
                <label for="pincode">Postal/Pin Code <span class="required">*</span></label>
                <input type="text" id="pincode" name="pincode" placeholder="e.g., 400001" required>
                <p class="helper-text">6-digit postal code for easy identification</p>
            </div>

            <!-- Description -->
            <div class="form-group">
                <label for="description">Property Description</label>
                <textarea id="description" name="description" placeholder="Describe your property: amenities, furnishings, nearby landmarks, facilities, house rules, etc."></textarea>
                <p class="helper-text">Help tenants understand what makes your property special</p>
            </div>

            <!-- Location Section -->
            <div class="location-section">
                <h3 style="margin-top:0;margin-bottom:12px;color:#0f172a">üìç House Location</h3>
                <p class="helper-text" style="margin-bottom:16px">Click on the map or enter the exact GPS coordinates of your property</p>
                
                <div class="map-container" id="mapContainer" title="Click to enter location">
                    <div style="text-align:center">
                        <div style="font-size:32px;margin-bottom:8px">üó∫Ô∏è</div>
                        <p style="margin:0;color:var(--muted)">Click here to set location or enter coordinates below</p>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="latitude">Latitude <span class="required">*</span></label>
                        <input type="number" id="latitude" name="latitude" placeholder="e.g., 19.0760" step="0.0001" required>
                        <p class="helper-text">Geographic latitude coordinate</p>
                    </div>
                    <div class="form-group">
                        <label for="longitude">Longitude <span class="required">*</span></label>
                        <input type="number" id="longitude" name="longitude" placeholder="e.g., 72.8777" step="0.0001" required>
                        <p class="helper-text">Geographic longitude coordinate</p>
                    </div>
                </div>

                <div class="location-info">
                    <strong>üìå Current Location:</strong><br>
                    <span id="locationDisplay">No location selected yet. Click on the map or enter coordinates.</span>
                </div>
            </div>

            <!-- Submit -->
            <button type="submit" class="btn">Next: Upload Images ‚Üí</button>
        </form>

        <!-- Back Link -->
        <div class="form-footer">
            <a th:href="@{/role-selection}">‚Üê Back</a>
        </div>
    </div>
</div>

<!-- Location Selection Script -->
<script>
document.getElementById('mapContainer').addEventListener('click', function() {
    const lat = prompt('Enter latitude (e.g., 19.0760):', '');
    if (lat === null) return;
    
    const lon = prompt('Enter longitude (e.g., 72.8777):', '');
    if (lon === null) return;
    
    if (!isValidCoordinate(lat) || !isValidCoordinate(lon)) {
        alert('Please enter valid coordinates');
        return;
    }
    
    document.getElementById('latitude').value = parseFloat(lat).toFixed(4);
    document.getElementById('longitude').value = parseFloat(lon).toFixed(4);
    updateLocationDisplay();
});

document.getElementById('latitude').addEventListener('change', updateLocationDisplay);
document.getElementById('longitude').addEventListener('change', updateLocationDisplay);

function isValidCoordinate(coord) {
    const num = parseFloat(coord);
    return !isNaN(num) && isFinite(num);
}

function updateLocationDisplay() {
    const lat = document.getElementById('latitude').value;
    const lon = document.getElementById('longitude').value;
    const display = document.getElementById('locationDisplay');
    
    if (lat && lon) {
        display.textContent = `Latitude: ${lat}, Longitude: ${lon}`;
    } else {
        display.textContent = 'No location selected yet. Click on the map or enter coordinates.';
    }
}
</script>
</body>
</html>
